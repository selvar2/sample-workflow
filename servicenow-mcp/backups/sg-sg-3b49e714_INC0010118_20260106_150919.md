# Security Group Backup - sg-3b49e714

## Incident Information
- **Incident Number:** INC0010118
- **Operation:** Add Inbound Rule
- **Timestamp:** 2026-01-06 15:09:19 UTC
- **Generated By:** MCP Server Automation

---

## Security Group Details

| Property | Value |
|----------|-------|
| Security Group ID | `sg-3b49e714` |
| Security Group Name | `default` |
| VPC ID | `vpc-28595d52` |
| Description | default VPC security group |
| Owner ID | 175853813947 |

---

## Change Summary

**Operation:** Add Inbound Rule

| Parameter | Value |
|-----------|-------|
| CIDR | `22.0.0.0/8, 23.0.0.0/8, 24.0.0.0/8, 19.0.0.0/8` |
| Port | `5439` |
| Protocol | `tcp` |
| Rule Description | MCP Server Automation |

---

## Before State (Existing Rules)

```hcl
# Security Group: default
# State: BEFORE operation

resource "aws_security_group" "default" {
  name        = "default"
  description = "default VPC security group"
  vpc_id      = "vpc-28595d52"
}

# Rule ID: sgr-008bc043d1a335473
resource "aws_security_group_rule" "default_egress_0" {
  type              = "egress"
  from_port         = -1
  to_port           = -1
  protocol          = "-1"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

# Rule ID: sgr-06e70afe660bee0cf
resource "aws_security_group_rule" "default_ingress_1" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["17.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "MCP Server Automation"
}

# Rule ID: sgr-056fd68c41b401551
resource "aws_security_group_rule" "default_ingress_2" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["20.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "MCP Server Automation"
}

# Rule ID: sgr-081d4d5abe0bbae66
resource "aws_security_group_rule" "default_ingress_3" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["11.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "Added by mcp server"
}

# Rule ID: sgr-09d41dd3dbc3507fd
resource "aws_security_group_rule" "default_ingress_4" {
  type              = "ingress"
  from_port         = -1
  to_port           = -1
  protocol          = "-1"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

# Rule ID: sgr-0ea5482e1bc135945
resource "aws_security_group_rule" "default_ingress_5" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["14.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "Testing new work notes format"
}

# Rule ID: sgr-0cc4753136d9b0f60
resource "aws_security_group_rule" "default_ingress_6" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["13.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "Added by MCP server for testing"
}

# Rule ID: sgr-0cf9bc781a0b48a62
resource "aws_security_group_rule" "default_ingress_7" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

# Rule ID: sgr-0f35636ee05280d30
resource "aws_security_group_rule" "default_ingress_8" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["19.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "MCP Server Automation"
}

# Rule ID: sgr-05f653a89a9be3e9e
resource "aws_security_group_rule" "default_ingress_9" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["21.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "MCP Server Automation"
}

# Rule ID: sgr-05814197943f1161b
resource "aws_security_group_rule" "default_ingress_10" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["16.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "MCP Server Automation"
}

# Rule ID: sgr-0d80eb56f9cf1bc21
resource "aws_security_group_rule" "default_ingress_11" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["10.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "Added by mcp server"
}

# Rule ID: sgr-04c1e97681504ad94
resource "aws_security_group_rule" "default_ingress_12" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["15.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "Testing updated work notes format"
}

```

### Before Rules Table

| Rule ID | Direction | CIDR | Port Range | Protocol | Description |
|---------|-----------|------|------------|----------|-------------|
| `sgr-008bc043d1a335473` | Outbound | `0.0.0.0/0` | -1--1 | -1 |  |
| `sgr-06e70afe660bee0cf` | Inbound | `17.0.0.0/8` | 5439-5439 | tcp | MCP Server Automation |
| `sgr-056fd68c41b401551` | Inbound | `20.0.0.0/8` | 5439-5439 | tcp | MCP Server Automation |
| `sgr-081d4d5abe0bbae66` | Inbound | `11.0.0.0/8` | 5439-5439 | tcp | Added by mcp server |
| `sgr-09d41dd3dbc3507fd` | Inbound | `0.0.0.0/0` | -1--1 | -1 |  |
| `sgr-0ea5482e1bc135945` | Inbound | `14.0.0.0/8` | 5439-5439 | tcp | Testing new work notes format |
| `sgr-0cc4753136d9b0f60` | Inbound | `13.0.0.0/8` | 5439-5439 | tcp | Added by MCP server for testing |
| `sgr-0cf9bc781a0b48a62` | Inbound | `0.0.0.0/0` | 5439-5439 | tcp |  |
| `sgr-0f35636ee05280d30` | Inbound | `19.0.0.0/8` | 5439-5439 | tcp | MCP Server Automation |
| `sgr-05f653a89a9be3e9e` | Inbound | `21.0.0.0/8` | 5439-5439 | tcp | MCP Server Automation |
| `sgr-05814197943f1161b` | Inbound | `16.0.0.0/8` | 5439-5439 | tcp | MCP Server Automation |
| `sgr-0d80eb56f9cf1bc21` | Inbound | `10.0.0.0/8` | 5439-5439 | tcp | Added by mcp server |
| `sgr-04c1e97681504ad94` | Inbound | `15.0.0.0/8` | 5439-5439 | tcp | Testing updated work notes format |

---

## Change Applied

```hcl
# Operation: Add Inbound Rule

resource "aws_security_group_rule" "default_change" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["22.0.0.0/8, 23.0.0.0/8, 24.0.0.0/8, 19.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "MCP Server Automation"
}
```

---

## After State (Updated Rules)

```hcl
# State: AFTER operation

resource "aws_security_group" "default" {
  name        = "default"
  description = "default VPC security group"
  vpc_id      = "vpc-28595d52"
}

resource "aws_security_group_rule" "default_egress_0" {
  type              = "egress"
  from_port         = -1
  to_port           = -1
  protocol          = "-1"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

resource "aws_security_group_rule" "default_ingress_1" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["17.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "MCP Server Automation"
}

resource "aws_security_group_rule" "default_ingress_2" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["20.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "MCP Server Automation"
}

resource "aws_security_group_rule" "default_ingress_3" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["11.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "Added by mcp server"
}

resource "aws_security_group_rule" "default_ingress_4" {
  type              = "ingress"
  from_port         = -1
  to_port           = -1
  protocol          = "-1"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

resource "aws_security_group_rule" "default_ingress_5" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["14.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "Testing new work notes format"
}

resource "aws_security_group_rule" "default_ingress_6" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["23.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "MCP Server Automation"
}

resource "aws_security_group_rule" "default_ingress_7" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["13.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "Added by MCP server for testing"
}

resource "aws_security_group_rule" "default_ingress_8" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

resource "aws_security_group_rule" "default_ingress_9" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["19.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "MCP Server Automation"
}

resource "aws_security_group_rule" "default_ingress_10" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["24.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "MCP Server Automation"
}

resource "aws_security_group_rule" "default_ingress_11" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["21.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "MCP Server Automation"
}

resource "aws_security_group_rule" "default_ingress_12" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["22.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "MCP Server Automation"
}

resource "aws_security_group_rule" "default_ingress_13" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["16.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "MCP Server Automation"
}

resource "aws_security_group_rule" "default_ingress_14" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["10.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "Added by mcp server"
}

resource "aws_security_group_rule" "default_ingress_15" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["15.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "Testing updated work notes format"
}

```

### After Rules Table

| Rule ID | Direction | CIDR | Port Range | Protocol | Description |
|---------|-----------|------|------------|----------|-------------|
| `sgr-008bc043d1a335473` | Outbound | `0.0.0.0/0` | -1--1 | -1 |  |
| `sgr-06e70afe660bee0cf` | Inbound | `17.0.0.0/8` | 5439-5439 | tcp | MCP Server Automation |
| `sgr-056fd68c41b401551` | Inbound | `20.0.0.0/8` | 5439-5439 | tcp | MCP Server Automation |
| `sgr-081d4d5abe0bbae66` | Inbound | `11.0.0.0/8` | 5439-5439 | tcp | Added by mcp server |
| `sgr-09d41dd3dbc3507fd` | Inbound | `0.0.0.0/0` | -1--1 | -1 |  |
| `sgr-0ea5482e1bc135945` | Inbound | `14.0.0.0/8` | 5439-5439 | tcp | Testing new work notes format |
| `sgr-071307c1669b16e67` | Inbound | `23.0.0.0/8` | 5439-5439 | tcp | MCP Server Automation |
| `sgr-0cc4753136d9b0f60` | Inbound | `13.0.0.0/8` | 5439-5439 | tcp | Added by MCP server for testing |
| `sgr-0cf9bc781a0b48a62` | Inbound | `0.0.0.0/0` | 5439-5439 | tcp |  |
| `sgr-0f35636ee05280d30` | Inbound | `19.0.0.0/8` | 5439-5439 | tcp | MCP Server Automation |
| `sgr-0193d5dc74b242fcb` | Inbound | `24.0.0.0/8` | 5439-5439 | tcp | MCP Server Automation |
| `sgr-05f653a89a9be3e9e` | Inbound | `21.0.0.0/8` | 5439-5439 | tcp | MCP Server Automation |
| `sgr-001c1ec2ecb1230c2` | Inbound | `22.0.0.0/8` | 5439-5439 | tcp | MCP Server Automation |
| `sgr-05814197943f1161b` | Inbound | `16.0.0.0/8` | 5439-5439 | tcp | MCP Server Automation |
| `sgr-0d80eb56f9cf1bc21` | Inbound | `10.0.0.0/8` | 5439-5439 | tcp | Added by mcp server |
| `sgr-04c1e97681504ad94` | Inbound | `15.0.0.0/8` | 5439-5439 | tcp | Testing updated work notes format |

---

## Rollback Instructions

```bash
aws ec2 revoke-security-group-ingress --group-id sg-3b49e714 --protocol tcp --port 5439 --cidr 22.0.0.0/8, 23.0.0.0/8, 24.0.0.0/8, 19.0.0.0/8 --region us-east-1 --no-cli-pager
```

---
*Generated by MCP Server Security Group Processor*
