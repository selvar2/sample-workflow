# Security Group Backup - sg-3b49e714

## Incident Information
- **Incident Number:** INC0010135
- **Operation:** Add Inbound Rule
- **Timestamp:** 2026-01-08 16:00:24 UTC
- **Generated By:** MCP Server Automation

---

## Security Group Details

| Property | Value |
|----------|-------|
| Security Group ID | `sg-3b49e714` |
| Security Group Name | `default` |
| VPC ID | `vpc-28595d52` |
| Description | default VPC security group |
| Owner ID | 175853813947 |

---

## Change Summary

**Operation:** Add Inbound Rule

| Parameter | Value |
|-----------|-------|
| CIDR | `28.0.0.0/8` |
| Port | `5439` |
| Protocol | `tcp` |
| Rule Description | MCP Server Automation |

---

## Before State (Existing Rules)

```hcl
# Security Group: default
# State: BEFORE operation

resource "aws_security_group" "default" {
  name        = "default"
  description = "default VPC security group"
  vpc_id      = "vpc-28595d52"
}

# Rule ID: sgr-0cf9bc781a0b48a62
resource "aws_security_group_rule" "default_ingress_0" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

# Rule ID: sgr-008bc043d1a335473
resource "aws_security_group_rule" "default_egress_1" {
  type              = "egress"
  from_port         = -1
  to_port           = -1
  protocol          = "-1"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

# Rule ID: sgr-09d41dd3dbc3507fd
resource "aws_security_group_rule" "default_ingress_2" {
  type              = "ingress"
  from_port         = -1
  to_port           = -1
  protocol          = "-1"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

```

### Before Rules Table

| Rule ID | Direction | CIDR | Port Range | Protocol | Description |
|---------|-----------|------|------------|----------|-------------|
| `sgr-0cf9bc781a0b48a62` | Inbound | `0.0.0.0/0` | 5439-5439 | tcp |  |
| `sgr-008bc043d1a335473` | Outbound | `0.0.0.0/0` | -1--1 | -1 |  |
| `sgr-09d41dd3dbc3507fd` | Inbound | `0.0.0.0/0` | -1--1 | -1 |  |

---

## Change Applied

```hcl
# Operation: Add Inbound Rule

resource "aws_security_group_rule" "default_change" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["28.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "MCP Server Automation"
}
```

---

## After State (Updated Rules)

```hcl
# State: AFTER operation

resource "aws_security_group" "default" {
  name        = "default"
  description = "default VPC security group"
  vpc_id      = "vpc-28595d52"
}

resource "aws_security_group_rule" "default_ingress_0" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

resource "aws_security_group_rule" "default_egress_1" {
  type              = "egress"
  from_port         = -1
  to_port           = -1
  protocol          = "-1"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

resource "aws_security_group_rule" "default_ingress_2" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["28.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "MCP Server Automation"
}

resource "aws_security_group_rule" "default_ingress_3" {
  type              = "ingress"
  from_port         = -1
  to_port           = -1
  protocol          = "-1"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

```

### After Rules Table

| Rule ID | Direction | CIDR | Port Range | Protocol | Description |
|---------|-----------|------|------------|----------|-------------|
| `sgr-0cf9bc781a0b48a62` | Inbound | `0.0.0.0/0` | 5439-5439 | tcp |  |
| `sgr-008bc043d1a335473` | Outbound | `0.0.0.0/0` | -1--1 | -1 |  |
| `sgr-0cef0f0f8c241b3ec` | Inbound | `28.0.0.0/8` | 5439-5439 | tcp | MCP Server Automation |
| `sgr-09d41dd3dbc3507fd` | Inbound | `0.0.0.0/0` | -1--1 | -1 |  |

---

## Rollback Instructions

```bash
aws ec2 revoke-security-group-ingress --group-id sg-3b49e714 --protocol tcp --port 5439 --cidr 28.0.0.0/8 --region us-east-1 --no-cli-pager
```

---
*Generated by MCP Server Security Group Processor*
