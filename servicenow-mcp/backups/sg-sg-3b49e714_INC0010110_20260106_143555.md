# Security Group Backup - sg-3b49e714

## Incident Information
- **Incident Number:** INC0010110
- **Operation:** Remove Inbound Rule
- **Timestamp:** 2026-01-06 14:35:55 UTC
- **Generated By:** MCP Server Automation

---

## Security Group Details

| Property | Value |
|----------|-------|
| Security Group ID | `sg-3b49e714` |
| Security Group Name | `default` |
| VPC ID | `vpc-28595d52` |
| Description | default VPC security group |
| Owner ID | 175853813947 |

---

## Change Summary

**Operation:** Remove Inbound Rule

| Parameter | Value |
|-----------|-------|
| CIDR | `12.0.0.0/8` |
| Port | `5439` |
| Protocol | `tcp` |
| Rule Description | Removed by MCP server for testing |

---

## Before State (Existing Rules)

```hcl
# Security Group: default
# State: BEFORE operation

resource "aws_security_group" "default" {
  name        = "default"
  description = "default VPC security group"
  vpc_id      = "vpc-28595d52"
}

# Rule ID: sgr-0cf9bc781a0b48a62
resource "aws_security_group_rule" "default_ingress_0" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

# Rule ID: sgr-008bc043d1a335473
resource "aws_security_group_rule" "default_egress_1" {
  type              = "egress"
  from_port         = -1
  to_port           = -1
  protocol          = "-1"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

# Rule ID: sgr-081d4d5abe0bbae66
resource "aws_security_group_rule" "default_ingress_2" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["11.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "Added by mcp server"
}

# Rule ID: sgr-09d41dd3dbc3507fd
resource "aws_security_group_rule" "default_ingress_3" {
  type              = "ingress"
  from_port         = -1
  to_port           = -1
  protocol          = "-1"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

# Rule ID: sgr-0d80eb56f9cf1bc21
resource "aws_security_group_rule" "default_ingress_4" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["10.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "Added by mcp server"
}

# Rule ID: sgr-0afff09549a74e26e
resource "aws_security_group_rule" "default_ingress_5" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["12.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "Added by MCP server for testing"
}

```

### Before Rules Table

| Rule ID | Direction | CIDR | Port Range | Protocol | Description |
|---------|-----------|------|------------|----------|-------------|
| `sgr-0cf9bc781a0b48a62` | Inbound | `0.0.0.0/0` | 5439-5439 | tcp |  |
| `sgr-008bc043d1a335473` | Outbound | `0.0.0.0/0` | -1--1 | -1 |  |
| `sgr-081d4d5abe0bbae66` | Inbound | `11.0.0.0/8` | 5439-5439 | tcp | Added by mcp server |
| `sgr-09d41dd3dbc3507fd` | Inbound | `0.0.0.0/0` | -1--1 | -1 |  |
| `sgr-0d80eb56f9cf1bc21` | Inbound | `10.0.0.0/8` | 5439-5439 | tcp | Added by mcp server |
| `sgr-0afff09549a74e26e` | Inbound | `12.0.0.0/8` | 5439-5439 | tcp | Added by MCP server for testing |

---

## Change Applied

```hcl
# Operation: Remove Inbound Rule

resource "aws_security_group_rule" "default_change" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["12.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "Removed by MCP server for testing"
}
```

---

## After State (Updated Rules)

```hcl
# State: AFTER operation

resource "aws_security_group" "default" {
  name        = "default"
  description = "default VPC security group"
  vpc_id      = "vpc-28595d52"
}

resource "aws_security_group_rule" "default_ingress_0" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

resource "aws_security_group_rule" "default_egress_1" {
  type              = "egress"
  from_port         = -1
  to_port           = -1
  protocol          = "-1"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

resource "aws_security_group_rule" "default_ingress_2" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["11.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "Added by mcp server"
}

resource "aws_security_group_rule" "default_ingress_3" {
  type              = "ingress"
  from_port         = -1
  to_port           = -1
  protocol          = "-1"
  cidr_blocks       = ["0.0.0.0/0"]
  security_group_id = aws_security_group.default.id
  description       = ""
}

resource "aws_security_group_rule" "default_ingress_4" {
  type              = "ingress"
  from_port         = 5439
  to_port           = 5439
  protocol          = "tcp"
  cidr_blocks       = ["10.0.0.0/8"]
  security_group_id = aws_security_group.default.id
  description       = "Added by mcp server"
}

```

### After Rules Table

| Rule ID | Direction | CIDR | Port Range | Protocol | Description |
|---------|-----------|------|------------|----------|-------------|
| `sgr-0cf9bc781a0b48a62` | Inbound | `0.0.0.0/0` | 5439-5439 | tcp |  |
| `sgr-008bc043d1a335473` | Outbound | `0.0.0.0/0` | -1--1 | -1 |  |
| `sgr-081d4d5abe0bbae66` | Inbound | `11.0.0.0/8` | 5439-5439 | tcp | Added by mcp server |
| `sgr-09d41dd3dbc3507fd` | Inbound | `0.0.0.0/0` | -1--1 | -1 |  |
| `sgr-0d80eb56f9cf1bc21` | Inbound | `10.0.0.0/8` | 5439-5439 | tcp | Added by mcp server |

---

## Rollback Instructions

```bash
aws ec2 authorize-security-group-ingress --group-id sg-3b49e714 --protocol tcp --port 5439 --cidr 12.0.0.0/8 --region us-east-1 --no-cli-pager
```

---
*Generated by MCP Server Security Group Processor*
